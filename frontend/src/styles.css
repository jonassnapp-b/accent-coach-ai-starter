@import "tailwindcss";

/* === Register Nocturne Serif (Extra-Bold 800) === */
@font-face{
  font-family: 'Nocturne Serif';
  src: url('/fonts/nocturne-serif-extrabold.woff2') format('woff2');
  font-weight: 800;
  font-style: normal;
  font-display: swap;
}

/* === Make EVERYTHING use Nocturne Serif === */
html {
  /* primary app font */
  font-family: 'Nocturne Serif', Georgia, 'Times New Roman', serif;
}
body { font-family: inherit; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
/* ensure form controls also use it */
button, input, select, textarea { font-family: inherit; }

/* keep old utility names but point them to the new font */
.font-brand { font-family: inherit; letter-spacing: .2px; }
.page-title { font-family: inherit; letter-spacing: -.2px; }

/* ======= THEME TOKENS ======= */
:root {
  --bg: #0f1116;
  --text: #e8eaee;

  --panel-bg: #181a21;
  --panel-text: #ffffff;
  --panel-border: rgba(255,255,255,0.08);

  --muted: rgba(255,255,255,0.6);

  --tabbar-bg: #0f1116;
  --tabbar-border: rgba(255,255,255,0.08);

  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --page-gutter-top: 20px;
  --page-gutter-x: 16px;

  --heading: #2196F3;
  --btn-shadow: 0 6px 14px rgba(0,0,0,.18);
  --btn-shadow-active: 0 3px 8px rgba(0,0,0,.22);

  --primary:#2196F3;
  --accent:#FF9800;
  --ring:rgba(33,150,243,0.35);
}
.theme-light {
  --bg: #fafafa;
  --text: #0b0d12;
  --panel-bg: #ffffff;
  --panel-text: #0b0d12;
  --panel-border: rgba(0,0,0,0.08);
  --muted: rgba(0,0,0,0.6);
  --tabbar-bg: #ffffff;
  --tabbar-border: rgba(0,0,0,0.08);
  --heading: #2196F3;
}
.theme-dark {}

*, *::before, *::after { box-sizing: border-box; }

/* ======= LAYOUT ======= */
.app-shell { max-width: 820px; margin: 24px auto; padding: 0 16px; }
.content {}

/* Panels */
.panel {
  background: var(--panel-bg);
  color: var(--panel-text);
  border: 1px solid var(--panel-border);
  border-radius: 18px;
  padding: 16px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.18);
}

.field { display: grid; gap: 6px; margin: 12px 0; max-width: 360px; }
.label { font-weight: 800; color: var(--text); } /* keep heavy weight for this serif */

/* ===== Buttons ===== */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  border-radius: 9999px;
  padding: 0.75rem 1.25rem;
  border: 1px solid var(--panel-border);
  background: rgba(255,255,255,.06);
  color: var(--panel-text);
  box-shadow: var(--btn-shadow);
  transition: transform .08s ease, filter .08s ease, box-shadow .12s ease, background .12s ease;
  -webkit-tap-highlight-color: transparent;
  text-decoration: none;
  cursor: pointer;
  font-weight: 800; /* serif weight */
}
.btn:disabled { opacity: .55; cursor: not-allowed; }
.btn:active { transform: translateY(1px) scale(0.98); filter: brightness(.97); box-shadow: var(--btn-shadow-active); }

/* initial gradient (overridden to solid blue later) */
.btn-primary {
  background-image: linear-gradient(90deg, #FF9800, #2196F3);
  color: #fff;
  border: none;
}
.btn-ghost { background: rgba(255,255,255,.08); }
.btn-sm { padding: 0.5rem 0.75rem; border-radius: 12px; }

/* Headers in brand blue */
.page-title, .page h1, .page h2 { color: var(--heading); }

/* Errors */
.error { margin-top: 8px; color: #e5484d; }

/* Chips */
.phoneme-row { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
.phoneme-chip { display: inline-flex; align-items: center; gap: 6px; border: 2px solid var(--panel-border); border-radius: 16px; padding: 6px 10px; }

/* Tabs */
.tab { text-transform: uppercase !important; font-weight: 800; letter-spacing: 0.5px; }

/* Spinner */
.spinner { width: 14px; height: 14px; border: 2px solid currentColor; border-top-color: transparent; border-radius: 50%; display: inline-block; vertical-align: -2px; margin-right: 8px; animation: spin 0.8s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* iOS long-press */
* { -webkit-user-select: none; -webkit-touch-callout: none; user-select: none; }
input, textarea { -webkit-user-select: text; user-select: text; }

/* Fill screen above tab bar */
html, body, #root { height: 100%; background: var(--bg); color: var(--text); }
.app-shell { min-height: 100vh; display: flex; flex-direction: column; }
.content { flex: 1; }

/* ======= Bottom tab bar ======= */
.with-bottom-tabs { padding-bottom: calc(64px + env(safe-area-inset-bottom)); }
.tabbar {
  position: fixed; left: 0; right: 0; bottom: 0;
  height: calc(64px + env(safe-area-inset-bottom));
  padding-bottom: max(env(safe-area-inset-bottom), 8px);
  background: var(--tabbar-bg);
  border-top: 1px solid var(--tabbar-border);
  display: grid; grid-template-columns: repeat(4, 1fr);
  align-items: center;
  z-index: 50;
}
.tabbtn { height: 100%; display: grid; place-items: center; gap: 4px; text-decoration: none; position: relative; color: var(--muted); }
.tabbtn .tabicon { width: 24px; height: 24px; image-rendering: -webkit-optimize-contrast; filter: saturate(0.9) brightness(0.95); }
.tabbtn .tablabel { font-size: 10px; line-height: 1; letter-spacing: 0.2px; color: var(--muted); }
.tabbtn.active .tabicon { filter: none; }
.tabbtn.active .tablabel { color: var(--text); }
.tabbtn:active .tabicon { transform: scale(0.94); }

/* === Page spacing === */
.page {
  width: 100%;
  min-height: calc(100vh - 4.5rem);
  padding-left: var(--page-gutter-x);
  padding-right: var(--page-gutter-x);
  padding-top: calc(var(--page-gutter-top) + var(--safe-top));
  padding-bottom: 12px;
  background: var(--bg);
  color: var(--text);
}

/* Settings layout */
.settings-page {
  max-width: 680px;
  width: 100%;
  margin: 0 auto;
  padding: 0 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}
.settings-page > div { width: 100%; max-width: 600px; }

/* Responsive tweaks */
@media (max-width: 360px) { :root { --page-gutter-x: 14px; } }
@media (min-width: 1024px) { :root { --page-gutter-top: 18px; } }

/* High-score glow */
.glow-highscore {
  box-shadow:
    0 0 0.5rem rgba(56, 189, 248, 0.3),
    0 0 1.25rem rgba(34, 197, 94, 0.35),
    0 0 2.25rem rgba(34, 197, 94, 0.25);
  transition: box-shadow 220ms ease;
}
.text-glow {
  text-shadow:
    0 0 8px rgba(56, 189, 248, 0.35),
    0 0 18px rgba(34, 197, 94, 0.35);
}

/* Background texture */
html,body,#root{
  background:
    radial-gradient(1200px 800px at 80% -10%, rgba(33,150,243,0.10), transparent 60%),
    radial-gradient(900px 600px at -10% 90%, rgba(255,152,0,0.08), transparent 55%),
    var(--bg);
}

/* Quiet cards */
.card-quiet{ background: rgba(255,255,255,0.04); border: 1px solid var(--panel-border); border-radius: 16px; }

/* Primary button polish (we force solid blue later) */
.btn-primary{
  background-image: linear-gradient(90deg, var(--accent), var(--primary));
  color:#fff; font-weight:800;
  border-radius: 999px;
  box-shadow: 0 6px 14px rgba(33,150,243,0.28);
  transition: transform .08s ease, box-shadow .2s ease, filter .2s ease;
}
.btn-primary:active{ transform: translateY(1px) scale(.99); }
.btn-primary:disabled{ opacity:.6; box-shadow:none; }

.btn-ghost{ background: rgba(255,255,255,0.08); border: 1px solid var(--panel-border); border-radius: 12px; }
.btn-ghost:hover{ background: rgba(255,255,255,0.12); }

/* Selects: pill */
.select-pill{ background: transparent; border: 1px solid var(--panel-border); border-radius: 12px; padding: 10px 12px; color: var(--panel-text); }
.select-pill:focus{ outline: none; box-shadow: 0 0 0 4px var(--ring); }

/* Tiny chips */
.badge{ padding: 4px 8px; border-radius: 999px; background: rgba(33,150,243,0.12); border: 1px solid rgba(33,150,243,0.25); color: #9cccfb; font-weight:800; font-size:.78rem; }

/* Progress bar */
.progress{ height: 8px; border-radius: 999px; background: rgba(255,255,255,0.08); overflow: hidden; border: 1px solid var(--panel-border); }
.progress > span{
  display:block; height:100%; width:var(--pct,0%);
  background: linear-gradient(90deg, var(--accent), var(--primary));
  box-shadow: 0 0 8px rgba(33,150,243,0.45), 0 0 14px rgba(255,152,0,0.35);
  transition: width .35s ease, box-shadow .3s ease;
}

/* Inputs/textarea softer */
textarea, select{ backdrop-filter: saturate(115%); }

/* Shadows */
.shadow-lg{ box-shadow: 0 8px 18px rgba(0,0,0,0.22) !important; }

/* Score ring + progress fills */
.score-ring { width: 56px; height: 56px; border-radius: 999px; display: grid; place-items: center; font-weight: 800; color: #fff; background: linear-gradient(90deg, var(--accent, #FF9800), var(--heading, #2196F3)); box-shadow: 0 4px 12px rgba(0,0,0,0.18); }
.progress-row { display:flex; align-items:center; gap:10px; margin:8px 0; }
.progress-label { width:130px; font-size:13px; color: var(--muted); }
.progress-track { flex:1; height:10px; background:rgba(255,255,255,0.08); border-radius:999px; overflow:hidden; }
.progress-fill { height:100%; border-radius:999px; transition: width .35s ease; }
.fill-good { background:#22c55e; }
.fill-okay { background:#f59e0b; }
.fill-bad  { background:#ef4444; }

/* Primary button micro feedback */
@keyframes btnPulse { 0%{transform:translateY(0) scale(1)} 50%{transform:translateY(0) scale(1.015)} 100%{transform:translateY(0) scale(1)} }
.btn-pulse { animation: btnPulse 1.2s ease-in-out infinite; will-change: transform; }

/* We no longer force sans weights here; headings already inherit Nocturne Serif */

/* --- TABS: icons only --- */
.tabbtn { gap: 0; position: relative; }
.tabbtn .tablabel { display: none; }
.tabbtn .tabicon { width: 28px; height: 28px; margin-top: 2px; }

/* Start button sparkle */
.btn-primary { position: relative; overflow: hidden; box-shadow: 0 0 18px rgba(33,150,243,0.4), 0 0 36px rgba(255,152,0,0.25); }
.btn-primary::before{
  content:""; position:absolute; top:-50%; left:-50%; width:200%; height:200%;
  background: radial-gradient(circle at center, rgba(255,255,255,0.15) 0%, transparent 60%);
  animation: btnPulseGlow 3s infinite ease-in-out; opacity:.6;
}
@keyframes btnPulseGlow { 0%,100%{ transform:scale(1); opacity:.5 } 50%{ transform:scale(1.2); opacity:.9 } }
.btn-primary::after{
  content:""; position:absolute; top:0; left:-100%; width:100%; height:100%;
  background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,0.6) 30%, rgba(255,255,255,0.8) 50%, rgba(255,255,255,0.6) 70%, transparent 100%);
  animation: shimmerMove 4s infinite;
}
@keyframes shimmerMove { 0%{left:-100%} 50%{left:100%} 100%{left:100%} }

/* Skeletons */
.skeleton-line { border-radius: 8px; background: linear-gradient(90deg, rgba(255,255,255,0.08), rgba(255,255,255,0.18), rgba(255,255,255,0.08)); background-size:200% 100%; animation: skeletonMove 1.2s ease-in-out infinite; }
@keyframes skeletonMove { 0%{background-position:200% 0} 100%{background-position:-200% 0} }

/* =========================================================
   BRAND RINGS
   ========================================================= */

/* (A) Textarea ring (Record) */
.brand-field { position: relative; border-radius: 22px; overflow: visible; line-height: 0; }
.brand-textarea{
  width:100%; resize:none; background: rgba(255,255,255,0.05);
  border: none; outline: none; color: var(--text);
  border-radius: 22px; position: relative; z-index: 1;
}
.brand-orbit{ position:absolute; inset:0; width:100%; height:100%; pointer-events:none; z-index:2; display:block; vertical-align:top; }
.brand-orbit .base,
.brand-orbit .dash{ shape-rendering:geometricPrecision; vector-effect:non-scaling-stroke; }
.brand-orbit .base{ stroke: rgba(33,150,243,.45); stroke-width:2; fill:none; }
.brand-orbit .dash{
  stroke:#2196f3; stroke-width:2; stroke-linecap:round; fill:none;
  stroke-dasharray: .08 1;
  stroke-dashoffset: 0;
  animation: orbitNorm 2.6s linear infinite;
}
@keyframes orbitNorm{ to { stroke-dashoffset:-1; } }

/* (B) Imitate & SpeakAlong card ring â€” same vivid rim */
.brand-field { border-radius: 28px; }
.brand-orbit.card { position:absolute; inset:-1px; width:calc(100% + 2px); height:calc(100% + 2px); pointer-events:none; }

.brand-field.imitate-ring .brand-orbit,
.brand-field.speak-ring .brand-orbit{
  inset:-1px; width:calc(100% + 2px); height:calc(100% + 2px);
}
.brand-field.imitate-ring .brand-orbit .base,
.brand-field.speak-ring   .brand-orbit .base{
  stroke: rgba(33,150,243,.45); stroke-width:2; fill:none;
}
.brand-field.imitate-ring .brand-orbit .dash,
.brand-field.speak-ring   .brand-orbit .dash{
  stroke:#2196F3; stroke-width:2; stroke-linecap:round; fill:none;
  stroke-dasharray:.12 1; animation: orbitNorm 2.2s linear infinite;
}

/* === Force Start-button solid blue === */
.btn-primary{
  background: var(--primary) !important;
  background-image: none !important;
  color:#fff;
}
